
#include "test.h"
#include "anc/anc_anc.h"

void run_test(void) {
	
	uint16_t input[100];
	
	initialize_sine(input);
	
	uint16_t i = 0;
	uint16_t predict = 0;
	int16_t error = 0;
	for (i = 0; i < 100; ++i) {
		predict = anc_predict(input[i]);
		error = (((int)input[i]) - 2048) + (((int)predict) - 2048);
		error += 2048;
		if (error < 0) {error = 0;}
		else if (error > 4096) {error = 4096;}
		anc_update((uint16_t) error);
	}
}

void initialize_sine(uint16_t input[]) {
	
	/*
	input[0] = 2068;
	input[1] = 2089;
	input[2] = 2109;
	input[3] = 2130;
	input[4] = 2150;
	input[5] = 2171;
	input[6] = 2191;
	input[7] = 2212;
	input[8] = 2232;
	input[9] = 2252;
	input[10] = 2273;
	input[11] = 2293;
	input[12] = 2313;
	input[13] = 2334;
	input[14] = 2354;
	input[15] = 2374;
	input[16] = 2394;
	input[17] = 2415;
	input[18] = 2435;
	input[19] = 2455;
	input[20] = 2475;
	input[21] = 2495;
	input[22] = 2515;
	input[23] = 2535;
	input[24] = 2555;
	input[25] = 2575;
	input[26] = 2594;
	input[27] = 2614;
	input[28] = 2634;
	input[29] = 2653;
	input[30] = 2673;
	input[31] = 2692;
	input[32] = 2712;
	input[33] = 2731;
	input[34] = 2750;
	input[35] = 2769;
	input[36] = 2789;
	input[37] = 2808;
	input[38] = 2827;
	input[39] = 2846;
	input[40] = 2864;
	input[41] = 2883;
	input[42] = 2902;
	input[43] = 2920;
	input[44] = 2939;
	input[45] = 2957;
	input[46] = 2976;
	input[47] = 2994;
	input[] = 3012;
	input[] = 3030;
	input[] = 3048;
	input[] = 3066;
	input[] = 3083;
	input[] = 3101;
	input[] = 3118;
	input[] = 3136;
	input[] = 3153;
	input[] = 3170;
	input[] = 3187;
	input[] = 3204;
	input[] = 3221;
	input[] = 3238;
	input[] = 3255;
	input[] = 3271;
	input[] = 3287;
	input[] = 3304;
	input[] = 3320;
	input[] = 3336;
	input[] = 3352;
	input[] = 3367;
	input[] = 3383;
	input[] = 3398;
	input[] = 3414;
	input[] = 3429;
	input[] = 3444;
	input[] = 3459;
	input[] = 3474;
	input[] = 3488;
	input[] = 3503;
	input[] = 3517;
	input[] = 3531;
	input[] = 3545;
	input[] = 3559;
	input[] = 3573;
	input[] = 3587;
	input[] = 3600;
	input[] = 3613;
	input[] = 3626;
	input[] = 3639;
	input[] = 3652;
	input[] = 3665;
	input[] = 3677;
	input[] = 3690;
	input[] = 3702;
	input[] = 3714;
	input[] = 3726;
	input[] = 3737;
	input[] = 3749;
	input[] = 3760;
	input[] = 3771;
	input[] = 3782;
	input[] = 3793;
	input[] = 3804;
	input[] = 3814;
	input[] = 3824;
	input[] = 3835;
	input[] = 3845;
	input[] = 3854;
	input[] = 3864;
	input[] = 3873;
	input[] = 3882;
	input[] = 3891;
	input[] = 3900;
	input[] = 3909;
	input[] = 3917;
	input[] = 3926;
	input[] = 3934;
	input[] = 3942;
	input[] = 3949;
	input[] = 3957;
	input[] = 3964;
	input[] = 3971;
	input[] = 3978;
	input[] = 3985;
	input[] = 3992;
	input[] = 3998;
	input[] = 4004;
	input[] = 4010;
	input[] = 4016;
	input[] = 4021;
	input[] = 4027;
	input[] = 4032;
	input[] = 4037;
	input[] = 4042;
	input[] = 4046;
	input[] = 4051;
	input[] = 4055;
	input[] = 4059;
	input[] = 4063;
	input[] = 4066;
	input[] = 4070;
	input[] = 4073;
	input[] = 4076;
	input[] = 4079;
	input[] = 4081;
	input[] = 4083;
	input[] = 4086;
	input[] = 4088;
	input[] = 4089;
	input[] = 4091;
	input[] = 4092;
	input[] = 4093;
	input[] = 4094;
	input[] = 4095;
	input[] = 4096;
	input[] = 4096;
	input[] = 4096;
	input[] = 4096;
	input[] = 4096;
	input[] = 4095;
	input[] = 4094;
	input[] = 4094;
	input[] = 4092;
	input[] = 4091;
	input[] = 4090;
	input[] = 4088;
	input[] = 4086;
	input[] = 4084;
	input[] = 4081;
	input[] = 4079;
	input[] = 4076;
	input[] = 4073;
	input[] = 4070;
	input[] = 4067;
	input[] = 4063;
	input[] = 4059;
	input[] = 4055;
	input[] = 4051;
	input[] = 4047;
	input[] = 4042;
	input[] = 4038;
	input[] = 4033;
	input[] = 4028;
	input[] = 4022;
	input[] = 4017;
	input[] = 4011;
	input[] = 4005;
	input[] = 3999;
	input[] = 3993;
	input[] = 3986;
	input[] = 3979;
	input[] = 3972;
	input[] = 3965;
	input[] = 3958;
	input[] = 3951;
	input[] = 3943;
	input[] = 3935;
	input[] = 3927;
	input[] = 3919;
	input[] = 3910;
	input[] = 3902;
	input[] = 3893;
	input[] = 3884;
	input[] = 3875;
	input[] = 3865;
	input[] = 3856;
	input[] = 3846;
	input[] = 3836;
	input[] = 3826;
	input[] = 3816;
	input[] = 3805;
	input[] = 3795;
	input[] = 3784;
	input[] = 3773;
	input[] = 3762;
	input[] = 3751;
	input[] = 3739;
	input[] = 3728;
	input[] = 3716;
	input[] = 3704;
	input[] = 3692;
	input[] = 3679;
	input[] = 3667;
	input[] = 3654;
	input[] = 3641;
	input[] = 3629;
	input[] = 3615;
	input[] = 3602;
	input[] = 3589;
	input[] = 3575;
	input[] = 3561;
	input[] = 3548;
	input[] = 3534;
	input[] = 3519;
	input[] = 3505;
	input[] = 3491;
	input[] = 3476;
	input[] = 3461;
	input[] = 3446;
	input[] = 3431;
	input[] = 3416;
	input[] = 3401;
	input[] = 3385;
	input[] = 3370;
	input[] = 3354;
	input[] = 3338;
	input[] = 3322;
	input[] = 3306;
	input[] = 3290;
	input[] = 3274;
	input[] = 3257;
	input[] = 3241;
	input[] = 3224;
	input[] = 3207;
	input[] = 3190;
	input[] = 3173;
	input[] = 3156;
	input[] = 3139;
	input[] = 3121;
	input[] = 3104;
	input[] = 3086;
	input[] = 3068;
	input[] = 3051;
	input[] = 3033;
	input[] = 3015;
	input[] = 2997;
	input[] = 2978;
	input[] = 2960;
	input[] = 2942;
	input[] = 2923;
	input[] = 2905;
	input[] = 2886;
	input[] = 2867;
	input[] = 2849;
	input[] = 2830;
	input[] = 2811;
	input[] = 2792;
	input[] = 2773;
	input[] = 2753;
	input[] = 2734;
	input[] = 2715;
	input[] = 2695;
	input[] = 2676;
	input[] = 2656;
	input[] = 2637;
	input[] = 2617;
	input[] = 2597;
	input[] = 2578;
	input[] = 2558;
	input[] = 2538;
	input[] = 2518;
	input[] = 2498;
	input[] = 2478;
	input[] = 2458;
	input[] = 2438;
	input[] = 2418;
	input[] = 2398;
	input[] = 2378;
	input[] = 2357;
	input[] = 2337;
	input[] = 2317;
	input[] = 2296;
	input[] = 2276;
	input[] = 2256;
	input[] = 2235;
	input[] = 2215;
	input[] = 2194;
	input[] = 2174;
	input[] = 2154;
	input[] = 2133;
	input[] = 2113;
	input[] = 2092;
	input[] = 2072;
	input[] = 2051;
	input[] = 2031;
	input[] = 2010;
	input[] = 1990;
	input[] = 1969;
	input[] = 1949;
	input[] = 1928;
	input[] = 1908;
	input[] = 1888;
	input[] = 1867;
	input[] = 1847;
	input[] = 1826;
	input[] = 1806;
	input[] = 1786;
	input[] = 1765;
	input[] = 1745;
	input[] = 1725;
	input[] = 1705;
	input[] = 1685;
	input[] = 1664;
	input[] = 1644;
	input[] = 1624;
	input[] = 1604;
	input[] = 1584;
	input[] = 1564;
	input[] = 1544;
	input[] = 1525;
	input[] = 1505;
	input[] = 1485;
	input[] = 1465;
	input[] = 1446;
	input[] = 1426;
	input[] = 1407;
	input[] = 1387;
	input[] = 1368;
	input[] = 1349;
	input[] = 1330;
	input[] = 1310;
	input[] = 1291;
	input[] = 1272;
	input[] = 1253;
	input[] = 1235;
	input[] = 1216;
	input[] = 1197;
	input[] = 1179;
	input[] = 1160;
	input[] = 1142;
	input[] = 1123;
	input[] = 1105;
	input[] = 1087;
	input[] = 1069;
	input[] = 1051;
	input[] = 1033;
	input[] = 1015;
	input[] = 998;
	input[] = 980;
	input[] = 963;
	input[] = 946;
	input[] = 928;
	input[] = 911;
	input[] = 894;
	input[] = 877;
	input[] = 861;
	input[] = 844;
	input[] = 828;
	input[] = 811;
	input[] = 795;
	input[] = 779;
	input[] = 763;
	input[] = 747;
	input[] = 731;
	input[] = 716;
	input[] = 700;
	input[] = 685;
	input[] = 669;
	input[] = 654;
	input[] = 639;
	input[] = 625;
	input[] = 610;
	input[] = 595;
	input[] = 581;
	input[] = 567;
	input[] = 553;
	input[] = 539;
	input[] = 525;
	input[] = 512;
	input[] = 498;
	input[] = 485;
	input[] = 472;
	input[] = 459;
	input[] = 446;
	input[] = 433;
	input[] = 421;
	input[] = 408;
	input[] = 396;
	input[] = 384;
	input[] = 372;
	input[] = 360;
	input[] = 349;
	input[] = 338;
	input[] = 326;
	input[] = 315;
	input[] = 305;
	input[] = 294;
	input[] = 283;
	input[] = 273;
	input[] = 263;
	input[] = 253;
	input[] = 243;
	input[] = 234;
	input[] = 224;
	input[] = 215;
	input[] = 206;
	input[] = 197;
	input[] = 188;
	input[] = 180;
	input[] = 172;
	input[] = 164;
	input[] = 156;
	input[] = 148;
	input[] = 140;
	input[] = 133;
	input[] = 126;
	input[] = 119;
	input[] = 112;
	input[] = 106;
	input[] = 99;
	input[] = 93;
	input[] = 87;
	input[] = 81;
	input[] = 76;
	input[] = 70;
	input[] = 65;
	input[] = 60;
	input[] = 55;
	input[] = 50;
	input[] = 46;
	input[] = 42;
	input[] = 38;
	input[] = 34;
	input[] = 30;
	input[] = 27;
	input[] = 24;
	input[] = 21;
	input[] = 18;
	input[] = 15;
	input[] = 13;
	input[] = 11;
	input[] = 9;
	input[] = 7;
	input[] = 5;
	input[] = 4;
	input[] = 3;
	input[] = 2;
	input[] = 1;
	input[] = 1;
	input[] = 0;
	input[] = 0;
	input[] = 0;
	input[] = 0;
	input[] = 1;
	input[] = 1;
	input[] = 2;
	input[] = 3;
	input[] = 5;
	input[] = 6;
	input[] = 8;
	input[] = 10;
	input[] = 12;
	input[] = 14;
	input[] = 17;
	input[] = 19;
	input[] = 22;
	input[] = 25;
	input[] = 29;
	input[] = 32;
	input[] = 36;
	input[] = 40;
	input[] = 44;
	input[] = 48;
	input[] = 53;
	input[] = 58;
	input[] = 62;
	input[] = 68;
	input[] = 73;
	input[] = 78;
	input[] = 84;
	input[] = 90;
	input[] = 96;
	input[] = 102;
	input[] = 109;
	input[] = 116;
	input[] = 122;
	input[] = 130;
	input[] = 137;
	input[] = 144;
	input[] = 152;
	input[] = 160;
	input[] = 168;
	input[] = 176;
	input[] = 184;
	input[] = 193;
	input[] = 202;
	input[] = 211;
	input[] = 220;
	input[] = 229;
	input[] = 239;
	input[] = 248;
	input[] = 258;
	input[] = 268;
	input[] = 279;
	input[] = 289;
	input[] = 299;
	input[] = 310;
	input[] = 321;
	input[] = 332;
	input[] = 344;
	input[] = 355;
	input[] = 367;
	input[] = 378;
	input[] = 390;
	input[] = 402;
	input[] = 415;
	input[] = 427;
	input[] = 440;
	input[] = 452;
	input[] = 465;
	input[] = 478;
	input[] = 492;
	input[] = 505;
	input[] = 519;
	input[] = 532;
	input[] = 546;
	input[] = 560;
	input[] = 574;
	input[] = 589;
	input[] = 603;
	input[] = 618;
	input[] = 632;
	input[] = 647;
	input[] = 662;
	input[] = 677;
	input[] = 693;
	input[] = 708;
	input[] = 724;
	input[] = 739;
	input[] = 755;
	input[] = 771;
	input[] = 787;
	input[] = 803;
	input[] = 820;
	input[] = 836;
	input[] = 853;
	input[] = 869;
	input[] = 886;
	input[] = 903;
	input[] = 920;
	input[] = 937;
	input[] = 955;
	input[] = 972;
	input[] = 989;
	input[] = 1007;
	input[] = 1025;
	input[] = 1043;
	input[] = 1060;
	input[] = 1078;
	input[] = 1096;
	input[] = 1115;
	input[] = 1133;
	input[] = 1151;
	input[] = 1170;
	input[] = 1188;
	input[] = 1207;
	input[] = 1226;
	input[] = 1244;
	input[] = 1263;
	input[] = 1282;
	input[] = 1301;
	input[] = 1320;
	input[] = 1340;
	input[] = 1359;
	input[] = 1378;
	input[] = 1398;
	input[] = 1417;
	input[] = 1437;
	input[] = 1456;
	input[] = 1476;
	input[] = 1495;
	input[] = 1515;
	input[] = 1535;
	input[] = 1555;
	input[] = 1575;
	input[] = 1595;
	input[] = 1615;
	input[] = 1635;
	input[] = 1655;
	input[] = 1675;
	input[] = 1695;
	input[] = 1715;
	input[] = 1736;
	input[] = 1756;
	input[] = 1776;
	input[] = 1796;
	input[] = 1817;
	input[] = 1837;
	input[] = 1857;
	input[] = 1878;
	input[] = 1898;
	input[] = 1919;
	input[] = 1939;
	input[] = 1960;
	input[] = 1980;
	input[] = 2001;
	input[] = 2021;
	input[] = 2041;
	input[] = 2062;
	*/
	
	return;
}